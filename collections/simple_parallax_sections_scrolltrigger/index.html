<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple parallax sections - ScrollTrigger</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/ScrollTrigger.min.js"></script>
    <style>
        section {
            position: relative;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            -webkit-transform: translateZ(0); /* necessary for iOS! */
        }
        h1 {
            color: white;
            text-shadow: 1px 1px 3px black;
            z-index: 1;
            font-size: 3em;
            font-weight: 400;
        }
        /* CSS specific to iOS devices */ 
        @supports (-webkit-overflow-scrolling: touch) {
            .fixed-bg {
                position: fixed;
                background-attachment: unset;
                -webkit-transform: translateZ(0); /* necessary for iOS! */
            }
        }
    </style>
</head>
<body>
    <section>
        <div class="bg"></div>
        <h1>Simple parallax sections</h1>
    </section>
    <section>
        <div class="bg"></div>
        <h1>Hey look, a title</h1>
    </section>
    <section>
        <div class="bg"></div>
        <h1>They just keep coming</h1>
    </section>
    <section>
        <div class="bg"></div>
        <h1>So smooth though</h1>
    </section>
    <section>
        <div class="bg"></div>
        <h1>Nice, right?</h1>
    </section>
</body>
<script>
    gsap.utils.toArray("section").forEach((section, i) => {
    section.bg = section.querySelector(".bg"); 

    // Give the backgrounds some random images
    section.bg.style.backgroundImage = `url(https://picsum.photos/${innerWidth}/${innerHeight}?random=${i})`;

    // Do the parallax effect on each section
    if (i) {
        section.bg.style.backgroundPosition = `50% ${innerHeight / 2}px`;

        gsap.to(section.bg, {
        backgroundPosition: `50% ${-innerHeight / 2}px`,
        ease: "none",
        scrollTrigger: {
            trigger: section,
            scrub: true
        }
        });
    } 
    
    // the first image should be positioned against the top. Use px on the animating part to work with GSAP. 
    else {
        section.bg.style.backgroundPosition = "50% 0px"; 

        gsap.to(section.bg, {
        backgroundPosition: `50% ${-innerHeight / 2}px`,
        ease: "none",
        scrollTrigger: {
            trigger: section,
            start: "top top", 
            end: "bottom top",
            scrub: true
        }
        });
    }
    });
</script>
</html>